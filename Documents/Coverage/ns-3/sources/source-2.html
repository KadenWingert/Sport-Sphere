


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > CommentController</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">coms309.Comment</a>
</div>

<h1>Coverage Summary for Class: CommentController (coms309.Comment)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">CommentController</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    77.8%
  </span>
  <span class="absValue">
    (7/9)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    84.4%
  </span>
  <span class="absValue">
    (38/45)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;
&nbsp;
&nbsp;/** @brief The coms 309. comment */
&nbsp;package coms309.Comment;
&nbsp;
&nbsp;import coms309.CommentMessage.CommentMessage;
&nbsp;import coms309.CommentMessage.CommentMessageRepository;
&nbsp;/** @brief The coms 309. exceptions. not found exception */
&nbsp;import coms309.Exceptions.NotFoundException;
&nbsp;/** @brief The coms 309. game post. game post */
&nbsp;import coms309.GamePost.GamePost;
&nbsp;/** @brief The coms 309. game post. game post repository */
&nbsp;import coms309.GamePost.GamePostRepository;
&nbsp;import coms309.Users.UserRepository;
&nbsp;import coms309.Users.Users;
&nbsp;/** @brief The org.reactivestreams. publisher */
&nbsp;import org.reactivestreams.Publisher;
&nbsp;/** @brief The org.springframework.beans.factory.annotation. autowired */
&nbsp;import org.springframework.beans.factory.annotation.Autowired;
&nbsp;/** @brief The org.springframework.graphql.data.method.annotation. argument */
&nbsp;import org.springframework.graphql.data.method.annotation.Argument;
&nbsp;/** @brief The org.springframework.graphql.data.method.annotation. mutation mapping */
&nbsp;import org.springframework.graphql.data.method.annotation.MutationMapping;
&nbsp;/** @brief The org.springframework.graphql.data.method.annotation. query mapping */
&nbsp;import org.springframework.graphql.data.method.annotation.QueryMapping;
&nbsp;/** @brief The org.springframework.graphql.data.method.annotation. subscription mapping */
&nbsp;import org.springframework.graphql.data.method.annotation.SubscriptionMapping;
&nbsp;/** @brief The org.springframework.stereotype. component */
&nbsp;import org.springframework.stereotype.Component;
&nbsp;/** @brief The org.springframework.stereotype. controller */
&nbsp;import org.springframework.stereotype.Controller;
&nbsp;/** @brief List of java.util.s */
&nbsp;import java.util.List;
&nbsp;
&nbsp;/**********************************************************************************************/
&nbsp;/**
&nbsp; * @class CommentController
&nbsp; *
&nbsp; * @brief A controller for handling comments.
&nbsp; *
&nbsp; * @author Arie
&nbsp; * @date 10/20/2023
&nbsp; **************************************************************************************************/
&nbsp;
&nbsp;/**********************************************************************************************/
&nbsp;/**
&nbsp; * @class CommentController
&nbsp; *
&nbsp; * @brief A controller for handling comments.
&nbsp; *
&nbsp; * @author Arie
&nbsp; * @date 10/30/2023
&nbsp; **************************************************************************************************/
&nbsp;
&nbsp;@Controller
&nbsp;@Component
<b class="fc">&nbsp;public class CommentController {</b>
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @property @Autowired CommentRepository commentRepository
&nbsp;     *
&nbsp;     * @brief Gets the comment repository
&nbsp;     *
&nbsp;     * @returns The comment repository.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @property @Autowired CommentRepository commentRepository
&nbsp;     *
&nbsp;     * @brief Gets the comment repository
&nbsp;     *
&nbsp;     * @returns The comment repository.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @Autowired
&nbsp;    CommentRepository commentRepository;
&nbsp;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @property @Autowired GamePostRepository gamePostRepository
&nbsp;     *
&nbsp;     * @brief Gets the game post repository
&nbsp;     *
&nbsp;     * @returns The game post repository.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @Autowired
&nbsp;    GamePostRepository gamePostRepository;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @property @Autowired CommentPublisher commentPublisher
&nbsp;     *
&nbsp;     * @brief Gets the comment publisher
&nbsp;     *
&nbsp;     * @returns The comment publisher.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @Autowired
&nbsp;    CommentPublisher commentPublisher;
&nbsp;
&nbsp;    @Autowired
&nbsp;    CommentMessageRepository commentMessageRepository;
&nbsp;
&nbsp;    @Autowired
&nbsp;    UserRepository userRepository;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @QueryMapping public List&lt;Comment&gt; getAllComments()
&nbsp;     *
&nbsp;     * @brief Gets all comments
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @returns all comments.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @QueryMapping
&nbsp;    public List&lt;Comment&gt; getAllComments() {
&nbsp;
<b class="fc">&nbsp;        return commentRepository.findAll();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @QueryMapping public Comment getCommentById(@Argument int id)
&nbsp;     *
&nbsp;     * @brief Gets comment by identifier
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @exception NotFoundException Thrown when the requested element is not present.
&nbsp;     *
&nbsp;     * @param id The identifier.
&nbsp;     *
&nbsp;     * @returns The comment by identifier.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @QueryMapping
&nbsp;    public Comment getCommentById(@Argument int id) {
<b class="fc">&nbsp;        Comment comment = commentRepository.findById((id));</b>
<b class="fc">&nbsp;        if (comment == null) {</b>
<b class="nc">&nbsp;            throw new NotFoundException(&quot;Comment with ID &quot; + id + &quot; not found&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        return comment;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @MutationMapping public Comment createComment(@Argument int game_post_id, @Argument
&nbsp;     *     String comment_message)
&nbsp;     *
&nbsp;     * @brief Creates a comment
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @exception NotFoundException Thrown when the requested element is not present.
&nbsp;     *
&nbsp;     * @param game_post_id Identifier for the game post.
&nbsp;     * @param comment_message Message describing the comment.
&nbsp;     * 
&nbsp;     * @returns The new comment.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @MutationMapping
&nbsp;    public Comment createComment(@Argument int game_post_id, @Argument String comment_details,
&nbsp;            @Argument int user_id) {
<b class="fc">&nbsp;        GamePost gamePost = gamePostRepository.findById(game_post_id);</b>
<b class="fc">&nbsp;        Users userID = userRepository.findById(user_id);</b>
&nbsp;
<b class="fc">&nbsp;        if (gamePost == null) {</b>
<b class="nc">&nbsp;            throw new NotFoundException(&quot;Could not find Game Post with id: &quot; + game_post_id);</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        Comment comment = new Comment(gamePost, userID);</b>
<b class="fc">&nbsp;        commentRepository.save(comment);</b>
&nbsp;
<b class="fc">&nbsp;        CommentMessage commentMessage = new CommentMessage(comment_details, comment);</b>
<b class="fc">&nbsp;        commentMessageRepository.save(commentMessage);</b>
&nbsp;
<b class="fc">&nbsp;        Comment result = commentRepository.findById(comment.getId());</b>
<b class="fc">&nbsp;        if (result != null) {</b>
<b class="nc">&nbsp;            commentPublisher.publish(result);</b>
&nbsp;        }
&nbsp;        // return comment;
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @MutationMapping public Comment updateComment(@Argument int comment_id, @Argument String
&nbsp;     *     new_message)
&nbsp;     *
&nbsp;     * @brief Updates the comment
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @exception NotFoundException Thrown when the requested element is not present.
&nbsp;     *
&nbsp;     * @param comment_id Identifier for the comment.
&nbsp;     * @param new_message Message describing the new.
&nbsp;     *
&nbsp;     * @returns A Comment.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @MutationMapping
&nbsp;    public Comment updateComment(@Argument int comment_id, @Argument String new_message) {
<b class="fc">&nbsp;        Comment comment = commentRepository.findById(comment_id);</b>
<b class="fc">&nbsp;        if (comment == null)</b>
<b class="nc">&nbsp;            throw new NotFoundException(&quot;Could not find comment with id: &quot; + comment_id);</b>
<b class="fc">&nbsp;        if (new_message != null) {</b>
<b class="fc">&nbsp;            CommentMessage commentMessage = comment.getComment_details();</b>
<b class="fc">&nbsp;            commentMessage.setMessage(new_message);</b>
<b class="fc">&nbsp;            comment.setMessage(commentMessage);</b>
<b class="fc">&nbsp;            commentMessageRepository.save(commentMessage);</b>
&nbsp;        }
<b class="fc">&nbsp;        commentRepository.save(comment);</b>
<b class="fc">&nbsp;        Comment result = commentRepository.findById(comment_id);</b>
&nbsp;
<b class="fc">&nbsp;        commentPublisher.publish(result);</b>
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @MutationMapping public Comment deleteCommentById(@Argument int id)
&nbsp;     *
&nbsp;     * @brief Deletes the comment by identifier described by ID
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @exception NotFoundException Thrown when the requested element is not present.
&nbsp;     *
&nbsp;     * @param id The identifier.
&nbsp;     *
&nbsp;     * @returns A Comment.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @MutationMapping
&nbsp;    public Comment deleteCommentById(@Argument int id) {
<b class="fc">&nbsp;        Comment comment = commentRepository.findById(id);</b>
<b class="fc">&nbsp;        if (comment == null) {</b>
<b class="nc">&nbsp;            throw new NotFoundException(&quot;GamePost not found.&quot;);</b>
&nbsp;        }
<b class="fc">&nbsp;        GamePost gamePost = comment.getGamePost();</b>
<b class="fc">&nbsp;        gamePost.getComment().remove(comment);</b>
<b class="fc">&nbsp;        commentRepository.save(comment);</b>
<b class="fc">&nbsp;        commentPublisher.publish(comment);</b>
<b class="fc">&nbsp;        return comment;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @MutationMapping public String deleteAllComments()
&nbsp;     *
&nbsp;     * @brief Deletes all comments
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @returns A String.
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @MutationMapping
&nbsp;    public String deleteAllComments() {
<b class="fc">&nbsp;        for (Comment c : commentRepository.findAll()) {</b>
<b class="fc">&nbsp;            c.getGamePost().getComment().remove(c);</b>
<b class="fc">&nbsp;            gamePostRepository.save(c.getGamePost());</b>
&nbsp;        }
<b class="fc">&nbsp;        commentRepository.deleteAll();</b>
<b class="fc">&nbsp;        return &quot;All Comments have been deleted&quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @SubscriptionMapping public Publisher&lt;Comment&gt; subComments()
&nbsp;     *
&nbsp;     * @brief Sub comments
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @returns A Publisher&amp;lt;Comment&amp;gt;
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @SubscriptionMapping
&nbsp;    public Publisher&lt;Comment&gt; subComments() {
<b class="nc">&nbsp;        return commentPublisher.subComments();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**********************************************************************************************/
&nbsp;    /**
&nbsp;     * @fn @SubscriptionMapping public Publisher&lt;Comment&gt; subCommentsById(int id)
&nbsp;     *
&nbsp;     * @brief Sub comments by identifier
&nbsp;     *
&nbsp;     * @author Arie
&nbsp;     * @date 10/30/2023
&nbsp;     *
&nbsp;     * @param id The identifier.
&nbsp;     *
&nbsp;     * @returns A Publisher&amp;lt;Comment&amp;gt;
&nbsp;     **************************************************************************************************/
&nbsp;
&nbsp;    @SubscriptionMapping
&nbsp;    public Publisher&lt;Comment&gt; subCommentsById(@Argument int id) {
<b class="nc">&nbsp;        return commentPublisher.subCommentsById(id);</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-12-04 13:11</div>
</div>
</body>
</html>
